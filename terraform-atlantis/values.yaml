# Atlantis Helm Chart Values
# This file contains only the basic configuration for Atlantis deployment

# Service configuration
service:
  type: ClusterIP
  port: 80

# Replica configuration
replicaCount: ${replica_count}

# Resource configuration
resources:
  requests:
    memory: "256Mi"
    cpu: "100m"
  limits:
    memory: "1Gi"
    cpu: "500m"

# Persistent storage configuration
dataStorage: "${storage_size}"
storageClassName: "${storage_class}"

# Service account configuration
serviceAccount:
  create: false
  name: "atlantis"

# Environment variables
environment:
  ATLANTIS_PORT: "4141"
  ATLANTIS_DATA_DIR: "/atlantis-data"
  ATLANTIS_LOG_LEVEL: "info"
  ATLANTIS_WRITE_GIT_CREDS: "true"
  ATLANTIS_GH_USER: "${github_user}"
  ATLANTIS_GH_TOKEN: "${github_token}"
  ATLANTIS_GH_WEBHOOK_SECRET: "${github_webhook_secret}"
  ATLANTIS_REPO_ALLOWLIST: "${github_repo_allowlist}"

# Ingress configuration (using ALB with HTTPS)
ingress:
  enabled: true
  ingressClassName: "alb"
  annotations:
    kubernetes.io/ingress.class: alb
    alb.ingress.kubernetes.io/scheme: internet-facing
    alb.ingress.kubernetes.io/target-type: ip
    alb.ingress.kubernetes.io/load-balancer-name: "atlantis-alb"
    alb.ingress.kubernetes.io/group.name: "atlantis"
    alb.ingress.kubernetes.io/listen-ports: '[{"HTTP": 80}]'

  path: /
  pathType: Prefix

# Image configuration
image:
  repository: "ghcr.io/runatlantis/atlantis"
  tag: "v0.35.0"
  pullPolicy: "IfNotPresent"
